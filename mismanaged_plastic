# Based on this data set we will be completing the following objectives:
# 1. What is the absolute frequency distribuiton of plastic pollution in regards to each country's GDP per capita?
# 2. What is the relationship between the amount of plastic polluton and 

# Install packages needed for this project
install.packages("tidyverse")
install.packages("GGally")

# Load the installed packages so that they are available for us to use
library(tidyverse)
library(GGally)
# Create a data directory that can be reproducible



# Create a data directory that can be reproducible
####setwd("/Users/Cat/Desktop/STATISTICA/global plastic pollution")
#create the dataframe with the csv of global plastic production vs gdp per capita
globplasprodgdp<-read.csv("per-capita-plastic-waste-vs-gdp-per-capita.csv")
View(globplasprodgdp)
nrow(globplasprodgdp)
ncol(globplasprodgdp)
globmismplas<-read.csv("mismanaged-waste-global-total.csv")
View(globmismplas)
globpercapmisplas <- read.csv("per-capita-mismanaged-plastic-waste-vs-gdp-per-capita.csv")
View(globpercapmisplas)
glopercapmisplas_new <- filter(globpercapmisplas, Year=="2010" )
View(glopercapmisplas_new)
globpercapmisplas_new<-na.omit(glopercapmisplas_new)
View(globpercapmisplas_new)
summary(globpercapmisplas_new)
nrow(globpercapmisplas_new) #
#######


gpmp <- read.csv("per-capita-mismanaged-plastic-waste-vs-gdp-per-capita.csv")
###gpmp2010 <- filter(gpmp, Year=="2010" ) %>% na.omit(gpmp) %>% gpmp$Code <- NULL &>& gpmp%Year<- NULL %>% gpmp$Continent <- NULL

#to know how many countries remain we count the number of rows
nrow(gpmp_2010_new) #148
colnames(gpmp_2010_new) <- c("country", "mismanaged p



### Diego
gpmp2010 <- filter(gpmp, Year=="2010" )
gpmp2010_new<-na.omit(gpmp2010)
gpmp2010_final <- subset(gpmp2010_new, select = c("Entity", "Per.capita.mismanaged.plastic.waste", "GDP.per.capita..PPP..constant.2011.international...", "Total.population..Gapminder..HYDE...UN."))
colnames(gpmp2010_final) <- c("Country", "Mismanaged plastic waste per capita (per day/kg)", "GDP per capita", "Population")
view(gpmp2010_final)

summary(gpmp2010_final)
glimpse(gpmp2010_final)

quantiles <- quantile(gpmp2010_final[,2], probs = c(0.25, 0.5, 0.75))
quantiles

custom_breaks_waste <- c(0.00100, 0.01100, 0.03700, 0.08000, 0.29900)
hist(gpmp2010_final[,2], main="Number of countries per quartile of mismanaged plastic waste per capita", ylab="Number of countries", xlab="Mismanaged plastic waste per capita", breaks=custom_breaks_waste, col="green", border="black")

custom_breaks_GDP <- c(660.2, 4407.3, 11946.6, 28850.1, 125140.9)
hist(gpmp2010_final[,3], main="Number of countries per quartile of GDP per capita", ylab="Number of countries", xlab="GDP per capita", breaks=custom_breaks_GDP, col="green", border="black")

custom_breaks_pop <- c(1.000e+04, 1.308e+06, 6.419e+06, 2.921e+07, 1.369e+09)
hist(gpmp2010_final[,4], main="Number of countries per quartile of population (super pretty)", ylab="Number of countries", xlab="Population", breaks=custom_breaks_pop, col="green", border="black")


boxplot(gpmp2010_final[,2], main="Boxplot 1", ylab="Waste", col="green", border="black")


