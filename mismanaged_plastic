# Based on this data set we will be completing the following objectives:
# 1. What is the absolute frequency distribuiton of plastic pollution in regards to each country's GDP per capita?
# 2. What is the relationship between the amount of plastic polluton and 

# Install packages needed for this project
install.packages("tidyverse")
install.packages("GGally")

# Load the installed packages so that they are available for us to use
library(tidyverse)
library(GGally)
# Create a data directory that can be reproducible



# Create a data directory that can be reproducible
####setwd("/Users/Cat/Desktop/STATISTICA/global plastic pollution")
#create the dataframe with the csv of global plastic production vs gdp per capita
globplasprodgdp<-read.csv("per-capita-plastic-waste-vs-gdp-per-capita.csv")
View(globplasprodgdp)
nrow(globplasprodgdp)
ncol(globplasprodgdp)
globmismplas<-read.csv("mismanaged-waste-global-total.csv")
View(globmismplas)
globpercapmisplas <- read.csv("per-capita-mismanaged-plastic-waste-vs-gdp-per-capita.csv")
View(globpercapmisplas)
glopercapmisplas_new <- filter(globpercapmisplas, Year=="2010" )
View(glopercapmisplas_new)
globpercapmisplas_new<-na.omit(glopercapmisplas_new)
View(globpercapmisplas_new)
summary(globpercapmisplas_new)
nrow(globpercapmisplas_new) #
#######


gpmp <- read.csv("per-capita-mismanaged-plastic-waste-vs-gdp-per-capita.csv")
###gpmp2010 <- filter(gpmp, Year=="2010" ) %>% na.omit(gpmp) %>% gpmp$Code <- NULL &>& gpmp%Year<- NULL %>% gpmp$Continent <- NULL

#to know how many countries remain we count the number of rows
nrow(gpmp_2010_new) #148
colnames(gpmp_2010_new) <- c("country", "mismanaged p



### Diego
gpmp2010 <- filter(gpmp, Year=="2010" )
gpmp2010_new<-na.omit(gpmp2010)
gpmp2010_final <- subset(gpmp2010_new, select = c("Entity", "Per.capita.mismanaged.plastic.waste", "GDP.per.capita..PPP..constant.2011.international...", "Total.population..Gapminder..HYDE...UN."))
colnames(gpmp2010_final) <- c("Country", "Mismanaged plastic waste per capita (per day/kg)", "GDP per capita", "Population")
view(gpmp2010_final)

## Dataset description
# Overall
view(gpmp2010_final)
summary(gpmp2010_final)
glimpse(gpmp2010_final)

# Nature of the variables
class(gpmp2010_final[,1])
typeof(gpmp2010_final[,1])
class(gpmp2010_final[,2])
typeof(gpmp2010_final[,2])
class(gpmp2010_final[,3])
typeof(gpmp2010_final[,3])
class(gpmp2010_final[,4])
typeof(gpmp2010_final[,4])


# Measures of central tendency
mean(gpmp2010_final[,2])
median(gpmp2010_final[,2])
range(gpmp2010_final[,2])
quantile(gpmp2010_final[,2])
0.080 - 0.011  # interquartile range for waste
mean(gpmp2010_final[,3])
median(gpmp2010_final[,3])
range(gpmp2010_final[,3])
quantile(gpmp2010_final[,3])
28850.057 - 4407.301  # interquartile rage for GDP
mean(gpmp2010_final[,4])
median(gpmp2010_final[,4])
range(gpmp2010_final[,4])
quantile(gpmp2010_final[,4])
29206500 - 1308000  # interquartile range for population

quantiles <- quantile(gpmp2010_final[,2], probs = c(0.25, 0.5, 0.75))
quantiles

## Variances and standard deviations
var(gpmp2010_final[,2])  # this is the sample variance, which is the incorrect one!!
sd(gpmp2010_final[,2])
sd(gpmp2010_final[,3])
sd(gpmp2010_final[,4])

## Univariate graphs
custom_breaks_waste <- quantile(gpmp2010_final[,2])
hist(gpmp2010_final[,2], main="Number of countries per quartile of mismanaged plastic waste per capita", ylab="Number of countries", xlab="Mismanaged plastic waste per capita", breaks=custom_breaks_waste, col="green", border="black")

custom_breaks_GDP <- quantile(gpmp2010_final[,3])
hist(gpmp2010_final[,3], main="Number of countries per quartile of GDP per capita", ylab="Number of countries", xlab="GDP per capita", breaks=custom_breaks_GDP, col="green", border="black")

custom_breaks_pop <- quantile(gpmp2010_final[,4])
hist(gpmp2010_final[,4], main="Number of countries per quartile of population (super pretty)", ylab="Number of countries", xlab="Population", breaks=custom_breaks_pop, col="green", border="black")

boxplot(gpmp2010_final[,2], main="Boxplot 1", ylab="Waste", col="green", border="black")


